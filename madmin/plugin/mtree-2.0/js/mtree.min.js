+(function(b){var c={openIcon:"fa fa-caret-right",closeIcon:"fa fa-caret-down",data:[],html:false,indent:15,display:1,currentId:"",currentClass:"current",speed:100,url:true,onLoad:function(d){},onClick:function(e,d){}};var a={init:function(){this._$ele=b(this);a.unsubscribeEvents.call(this);a.initData.call(this)},unsubscribeEvents:function(){this._$ele.off("click")},initData:function(){if(!this.ops.html){this._$ele.html("")}a.genData.call(this,this._$ele,0,1);a.initIdent.call(this);a.inintShow.call(this);a.initCurrent.call(this);a.initBtnStatus.call(this);a.clearRedundancy(this)},genData:function(g,d,i){var h=this;var f=h.ops.data;var e=b(a.template.ul).data("level",i++);b.each(f,function(l,r){if(r.pid==d){var n=b(a.template.li);var j=b(a.template.a.replace(/\[expand\]/,r.expand)).attr("data-url",r.url).attr("data-id",r.id).attr("title",r.name);var p=b(a.template.indent);var o=(r.btn=="false")?"":b(a.template.btn).addClass(h.ops.openIcon);var m=(r.icon)?b(a.template.icon).addClass(r.icon):"";var q=b(a.template.name).html(r.name);var k=n.append(j.append(p).append(o).append(m).append(q));e.append(k);a.genData.call(h,k,r.id,i)}});if(e.html().length>0){g.append(e)}},initIdent:function(){var d=this;b('[data-name="mtreeLink"]',this._$ele).each(function(h){var g=b(this).closest("ul");var i=g.data("level");var f=(i-1)*d.ops.indent;b('[data-name="mtreeIndent"]',b(this)).css({width:f})})},clearRedundancy:function(){b('[data-name="mtreeLink"]',this._$ele).each(function(){if(b(this).next("ul").length==0){b('[data-name="mtreeBtn"]',b(this)).removeClass()}})},initBtnStatus:function(){var d=this;b('[data-name="mtreeLink"]',this._$ele).each(function(){if(b(this).next("ul").is(":hidden")){b(this).find('>[data-name="mtreeBtn"]').removeClass(d.ops.closeIcon).addClass(d.ops.openIcon)}else{b(this).find('>[data-name="mtreeBtn"]').removeClass(d.ops.openIcon).addClass(d.ops.closeIcon)}})},initCurrent:function(){if(this.ops.currentId){this._$ele.find('[data-name="mtreeLink"][data-id="'+this.ops.currentId+'"]').addClass(this.ops.currentClass).parents("li").addClass(this.ops.currentClass).parents("ul").show()}else{this._$ele.find("."+this.ops.currentClass+'[data-name="mtreeLink"]').parents("li").addClass(this.ops.currentClass).parents("ul").show()}},inintShow:function(){var d=this;b("ul",d._$ele).each(function(){var e=b(this).data("level");if(d.ops.display===true){b(this).show()}else{if(e>d.ops.display){b(this).hide()}}})},linkClick:function(){var f=this;var d=this.ops.openIcon;var e=this.ops.closeIcon;this._$ele.on("click",'[data-name="mtreeLink"]',function(j){var i=b(this).next("ul");var h=b(this).find(' > [data-name="mtreeBtn"]');var g=b(this).data("url");if(f.ops.url){if((typeof(g)=="undefined"?"":g).replace(/javascript:;|(#)*!/,"")){f.ops.onClick.call(f,b(this),b(this).data("url"))}else{if(i.size()){if(i.is(":hidden")){i.slideDown(f.ops.speed);h.removeClass(d).addClass(e)}else{i.slideUp(f.ops.speed);h.removeClass(e).addClass(d)}}}}else{f.ops.onClick.call(f,b(this),b(this).data("url"))}if(g){f.find('[data-name="mtreeLink"]').removeClass(f.ops.currentClass).parents("li").removeClass(f.ops.currentClass);b(this).addClass(f.ops.currentClass).parents("li").addClass(f.ops.currentClass)}else{f.find('[data-name="mtreeLink"]').parents("li").removeClass(f.ops.currentClass);b(this).parents("li").addClass(f.ops.currentClass)}j.preventDefault();j.stopPropagation()})},btnClick:function(){var f=this;var d=this.ops.openIcon;var e=this.ops.closeIcon;this._$ele.on("click",'[data-name="mtreeBtn"]',function(h){var g=b(this).closest('[data-name="mtreeLink"]').next("ul");if(g.size()){if(g.is(":hidden")){g.slideDown(f.ops.speed);b(this).removeClass(d).addClass(e)}else{g.slideUp(f.ops.speed);b(this).removeClass(e).addClass(d)}}h.preventDefault();h.stopPropagation()})},template:{ul:"<ul></ul>",li:"<li></li>",a:'<a href="javascript:;" data-name="mtreeLink" [expand]></a>',indent:'<div data-name="mtreeIndent"></div>',btn:'<div data-name="mtreeBtn"></div>',icon:'<div data-name="mtreeIcon"></div>',name:'<div data-name="mtreeName"></div>'}};b.fn.mtree=function(d){this.ops=b.extend({},c,d);a.init.call(this);a.linkClick.call(this);a.btnClick.call(this);this.ops.onLoad.call(this)}})(jQuery);